1. update head
2. update loss
3. 